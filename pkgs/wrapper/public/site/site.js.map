{
  "version": 3,
  "sources": ["../../../node_modules/react-dom/client.js", "../../web/src/render/site/site.tsx", "../../web/src/render/site/site-loader.tsx", "../../web/src/render/live/logic/mobile.ts", "../../web/src/render/site/mobile-loader.tsx"],
  "sourcesContent": ["'use strict';\n\nvar m = require('react-dom');\nif (process.env.NODE_ENV === 'production') {\n  exports.createRoot = m.createRoot;\n  exports.hydrateRoot = m.hydrateRoot;\n} else {\n  var i = m.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;\n  exports.createRoot = function(c, o) {\n    i.usingClientEntryPoint = true;\n    try {\n      return m.createRoot(c, o);\n    } finally {\n      i.usingClientEntryPoint = false;\n    }\n  };\n  exports.hydrateRoot = function(c, h, o) {\n    i.usingClientEntryPoint = true;\n    try {\n      return m.hydrateRoot(c, h, o);\n    } finally {\n      i.usingClientEntryPoint = false;\n    }\n  };\n}\n", "import { FC, useState } from \"react\";\nimport { createRoot } from \"react-dom/client\";\nimport { GlobalContext, defineReact, defineWindow } from \"web-utils\";\nimport { siteLoader } from \"./site-loader\";\nimport { registerMobile } from \"../live/logic/mobile\";\nimport { mobileLoader } from \"./mobile-loader\";\n\nconst w = window as unknown as {\n  prasiContext: any;\n  rootRender: any;\n  mobile: any;\n  mobilepath?: any;\n};\n\nif (!w.mobile) {\n  w.mobile = registerMobile();\n}\n\nw.prasiContext = {\n  global: {},\n  render() {},\n};\n\nconst Root: FC<{ url: URL; Live: any }> = ({ url, Live }) => {\n  const [_, render] = useState({});\n  w.prasiContext.render = () => {\n    render({});\n  };\n\n  const Provider = GlobalContext.Provider as FC<{ value: any; children: any }>;\n  return (\n    <Provider value={w.prasiContext}>\n      <Live\n        domain={url.host}\n        pathname={location.pathname}\n        loader={w.mobilepath ? mobileLoader : siteLoader}\n      />\n    </Provider>\n  );\n};\n\n(async () => {\n  const div = document.getElementById(\"root\");\n  if (div) {\n    const root = createRoot(div);\n    const url = new URL(location.href);\n    await defineWindow(false);\n    defineReact();\n    const { Live } = await import(\"../live/live\");\n    root.render(<Root url={url} Live={Live} />);\n    if (document.body.classList.contains(\"opacity-0\")) {\n      document.body.classList.remove(\"opacity-0\");\n    }\n  }\n})();\n", "import { w } from \"../../utils/script/init-api\";\nimport { Loader } from \"../live/logic/global\";\n\nconst base = `/_web/${(window as any).id_site}`;\n\nconst cache = { site: null as any, pages: [] as any, api: null };\n\nexport const siteLoader: Loader = {\n  async site(p, id) {\n    const res = (await load(`/site?prod=1`)) as {\n      site: any;\n      pages: any;\n      api: any;\n    };\n    cache.site = res.site;\n    cache.pages = res.pages;\n    cache.api = res.api;\n\n    w.serverurl = res.site.config.api_url;\n    w.apiurl = res.site.config.api_url;\n\n    w.prasiApi = {\n      [res.site.config.api_url]: { apiEntry: res.api },\n    };\n\n    return res.site;\n  },\n  async comp(p, id) {\n    const comp = (await load(`/comp/${id}`)) as any;\n    p.comps.all[id] = comp;\n    return comp;\n  },\n  npm(p, type, id) {\n    if (type === \"site\") return `/_web/${cache.site.id}/npm-site/site.js`;\n    return `/_web/${cache.site.id}/npm-page/${id}/page.js`;\n  },\n  async page(p, id) {\n    const page = cache.pages.find((x: any) => x.id === id);\n    if (page && !page.content_tree) {\n      const res = (await load(`/page/${id}`)) as any;\n      return res;\n    }\n    return null;\n  },\n  async pages(p, id) {\n    return cache.pages;\n  },\n};\n\nconst load = async (url: string) => {\n  const res = await fetch(`${base}${url}`);\n  const text = await res.text();\n  const json = JSON.parse(text);\n  return json;\n};\n", "import { w } from \"../../../utils/script/init-api\";\nimport { PG } from \"./global\";\n\ntype NOTIF_ARG = {\n  user_id: any;\n  body: string;\n  title: string;\n  data?: any;\n};\nexport const registerMobile = () => {\n  const default_mobile = {\n    send: () => {},\n    bind: (p: PG) => {},\n    notif: {\n      register: (user_id: string) => {},\n      send: async (data: NOTIF_ARG) => {\n        const p = getP();\n        if (p) {\n          return await p.script.api._notif(\"send\", {\n            type: \"send\",\n            id:\n              typeof data.user_id === \"string\"\n                ? data.user_id\n                : data.user_id.toString(),\n            body: data.body,\n            title: data.title,\n            data: data.data,\n          });\n        }\n      },\n      onTap: (data: NOTIF_ARG) => {},\n      onReceive: (data: NOTIF_ARG) => {},\n    },\n  };\n\n  let config = { notif_token: \"\", p: null as null | PG };\n  const getP = () => {\n    const p = config.p;\n    if (p && p.site && p.site.api_url) {\n      const api = w.prasiApi[p.site.api_url];\n      if (\n        api &&\n        api.apiEntry &&\n        api.apiEntry._notif &&\n        p.script &&\n        p.script.api\n      ) {\n        return p;\n      }\n    }\n  };\n\n  if (window.parent) {\n    window.addEventListener(\"message\", async ({ data: raw }) => {\n      if (typeof raw === \"object\" && raw.mobile) {\n        console.log(\"capacitor\", raw);\n        const data = raw as unknown as\n          | {\n              type: \"notification-token\";\n              token: string;\n            }\n          | { type: \"notification-tap\"; notif: NOTIF_ARG }\n          | { type: \"notification-receive\"; notif: NOTIF_ARG };\n\n        const waitUntil = async (fn: () => boolean) => {\n          if (!notifObject.notif.onTap) {\n            let ival = null as any;\n            let i = 0;\n            await new Promise(() => {\n              ival = setInterval(() => {\n                i++;\n                if (i > 20) {\n                  clearInterval(ival);\n                }\n                if (fn()) {\n                  clearInterval(ival);\n                }\n              }, 500);\n            });\n            return;\n          }\n        };\n\n        switch (data.type) {\n          case \"notification-token\":\n            config.notif_token = data.token;\n            break;\n          case \"notification-tap\":\n            if (!notifObject.notif.onTap) {\n              waitUntil(() => {\n                if (notifObject.notif.onTap) {\n                  notifObject.notif.onTap(data.notif);\n                  return true;\n                }\n                return false;\n              });\n              return;\n            }\n\n            if (notifObject.notif.onTap) {\n              notifObject.notif.onTap(data.notif);\n            }\n            break;\n          case \"notification-receive\":\n            if (!notifObject.notif.onReceive) {\n              waitUntil(() => {\n                if (notifObject.notif.onReceive) {\n                  notifObject.notif.onReceive(data.notif);\n                  return true;\n                }\n                return false;\n              });\n            }\n            if (notifObject.notif.onReceive) {\n              notifObject.notif.onReceive(data.notif);\n            }\n            break;\n        }\n      }\n    });\n\n    const notifObject = {\n      send: (msg: { type: \"ready\" }) => {\n        window.parent.postMessage({ mobile: true, ...msg }, \"*\");\n      },\n      bind(p: PG) {\n        config.p = p;\n      },\n      config,\n      notif: {\n        register: async (user_id: any) => {\n          const p = getP();\n          if (p) {\n            return await p.script.api._notif(\"register\", {\n              type: \"register\",\n              id: typeof user_id === \"string\" ? user_id : user_id.toString(),\n              token: config.notif_token,\n            });\n          }\n        },\n        send: async (data: NOTIF_ARG) => {\n          const p = getP();\n          if (p) {\n            return await p.script.api._notif(\"send\", {\n              type: \"send\",\n              id:\n                typeof data.user_id === \"string\"\n                  ? data.user_id\n                  : data.user_id.toString(),\n              body: data.body,\n              title: data.title,\n              data: data.data,\n            });\n          }\n        },\n        onTap: null as null | typeof default_mobile.notif.onTap,\n        onReceive: null as null | typeof default_mobile.notif.onReceive,\n      },\n    };\n    return notifObject;\n  }\n  return {\n    ...default_mobile,\n  };\n};\n", "import { w } from \"../../utils/script/init-api\";\nimport { Loader } from \"../live/logic/global\";\n\nconst cache = {\n  site: null as any,\n  pages: [] as any,\n  api: null,\n  npm_pages: [] as string[],\n};\n\nexport const mobileLoader: Loader = {\n  async site(p, id) {\n    const res = (await load(`/content/site/site.json`)) as any;\n    cache.site = res;\n\n    const pages = (await load(`/content/site/pages.json`)) as any;\n    cache.pages = pages;\n\n    const npm_pages = (await load(`/content/site/npm_pages.json`)) as any;\n    cache.npm_pages = npm_pages;\n\n    w.serverurl = res.config.api_url;\n    w.apiurl = res.config.api_url;\n\n    w.prasiApi = {\n      [res.config.api_url]: { apiEntry: res.api },\n    };\n\n    return res;\n  },\n  async comp(p, id) {\n    const comp = (await load(`/content/comps/${id}.json`)) as any;\n    p.comps.all[id] = comp;\n    return comp;\n  },\n  npm(p, type, id) {\n    if (type === \"site\") return `/content/npm/site/index.js`;\n    if (cache.npm_pages.includes(id)) {\n      return `/content/npm/pages/${id}/index.js`;\n    }\n    return \"\";\n  },\n  async page(p, id) {\n    const page = cache.pages.find((x: any) => x.id === id);\n    if (page && !page.content_tree) {\n      const res = (await load(`/content/pages/${id}.json`)) as any;\n\n      return res;\n    }\n    return null;\n  },\n  async pages(p, id) {\n    return cache.pages;\n  },\n};\n\nconst load = async (url: string) => {\n  const res = await fetch(`${w.mobilepath}${url}`);\n  const text = await res.text();\n  const json = JSON.parse(text);\n  return json;\n};\n"],
  "mappings": "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",
  "names": ["require_client", "__commonJSMin", "exports", "m", "i", "import_react", "import_client", "base", "cache", "siteLoader", "p", "id", "res", "load", "w", "comp", "type", "page", "x", "url", "text", "registerMobile", "default_mobile", "p", "user_id", "data", "getP", "config", "api", "w", "raw", "waitUntil", "fn", "notifObject", "ival", "i", "msg", "cache", "mobileLoader", "p", "id", "res", "load", "pages", "npm_pages", "w", "comp", "type", "page", "x", "url", "text", "import_jsx_runtime", "w", "registerMobile", "Root", "url", "Live", "_", "render", "Provider", "GlobalContext", "mobileLoader", "siteLoader", "div", "root", "defineWindow", "defineReact"]
}
